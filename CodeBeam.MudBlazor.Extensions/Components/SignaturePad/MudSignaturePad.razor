@using Microsoft.JSInterop
@using MudBlazor.Charts
@using MudBlazor.Utilities
@using System.Text
@namespace MudExtensions
@inject IJSRuntime JsRuntime
@inherits ComponentBase

<MudPaper Elevation="@Elevation" Class="@OuterClass">
    <div style="@CanvasContainerStyle" class="@CanvasContainerClass">
        <canvas @ref="_reference" id="@_id"></canvas>
    </div>
    <MudToolBar Style="@ToolbarStyle" Class="my-2">
        <MudStack Row="true" Class="justify-content-between align-center">
            @if (ShowLineWidth)
            {
                <MudNumericField T="decimal" Value="Options.LineWidth" ValueChanged="LineWidthUpdated" Label="@LocalizedStrings.LineWidth" Min="1" Step="1"></MudNumericField>
            }
            @if (ShowStrokeStyle)
            {
                <MudColorPicker Value="Options.StrokeStyle" ValueChanged="StrokeStyleUpdated" Label="@LocalizedStrings.StrokeColor"></MudColorPicker>
            }
            @if (ShowLineJoinStyle)
            {
                <MudSelect T="LineJoinTypes" Value="Options.LineJoinStyle" ValueChanged="LineJoinTypeUpdated" ToStringFunc="x => x.ToString()"
                           Label="@LocalizedStrings.LineJoinStyle">
                    @foreach (var value in Enum.GetValues<LineJoinTypes>())
                    {
                        <MudSelectItem T="LineJoinTypes" Value="value"></MudSelectItem>
                    }
                </MudSelect>
            }
            @if (ShowLineCapStyle)
            {
                <MudSelect T="LineCapTypes" Value="Options.LineCapStyle" ValueChanged="LineCapTypeUpdated" ToStringFunc="x => x.ToString()"
                           Label="@LocalizedStrings.LineCapStyle">
                    @foreach (var value in Enum.GetValues<LineCapTypes>())
                    {
                        <MudSelectItem T="LineCapTypes" Value="value"></MudSelectItem>
                    }
                </MudSelect>
            }

            <MudChip Variant="Variant.Filled" Icon="@DrawEraseChipIcon"
                     Value="_isErasing" OnClick="async () => await IsEditToggled()">
                @DrawEraseChipText
            </MudChip>
            @if (ShowDownload)
            {
                <MudChip OnClick="Download" Variant="Variant.Filled" Icon="@Icons.Material.Filled.Download">@LocalizedStrings.Download</MudChip>
            }
            @if (ShowClear)
            {
                <MudChip OnClick="ClearPad" Variant="Variant.Filled" Icon="@Icons.Material.Filled.Clear">@LocalizedStrings.Clear</MudChip>
            }
        </MudStack>
    </MudToolBar>
</MudPaper>